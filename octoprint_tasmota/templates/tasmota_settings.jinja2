<h4>Tasmota Settings</h4>
<table class="table table-condensed" data-bind='visible: settings.settings.plugins.tasmota.arrSmartplugs().length > 0'>
	<thead>
		<tr>
			<td>{{ _('Plug') }}</td>
			<td style="text-align:center">{{ _('Options') }}</td>
			<td style="text-align:center"><a href="#" class="btn btn-mini icon-plus" data-bind="click: addPlug"></a></td>
		</tr>
	</thead>
	<tbody data-bind='foreach: settings.settings.plugins.tasmota.arrSmartplugs'>
		<tr data-bind="attr: {title: ip}">
			<td>
				<span data-bind="text: label" />
			</td>
			<td style="text-align:center">
				<i class="icon" data-bind="css: {'icon-check': displayWarning(),'icon-check-empty': !displayWarning()}" title="Warning Prompt" />
				<i class="icon" data-bind="css: {'icon-check': warnPrinting(),'icon-check-empty': !warnPrinting()}" title="Warn While Printing" />
				<i class="icon" data-bind="css: {'icon-check': thermal_runaway(),'icon-check-empty': !thermal_runaway()}" title="Thermal Runaway" />
				<i class="icon" data-bind="css: {'icon-check': autoConnect(),'icon-check-empty': !autoConnect()}" title="Auto Connect" />
				<i class="icon" data-bind="css: {'icon-check': autoDisconnect(),'icon-check-empty': !autoDisconnect()}" title="Auto Disconnect" />
				<i class="icon" data-bind="css: {'icon-check': gcodeEnabled(),'icon-check-empty': !gcodeEnabled()}" title="GCODE Trigger" />
				<i class="icon" data-bind="css: {'icon-check': sysCmdOn(),'icon-check-empty': !sysCmdOn()}" title="Run System Command On" />
				<i class="icon" data-bind="css: {'icon-check': sysCmdOff(),'icon-check-empty': !sysCmdOff()}" title="Run System Command Off" />
			</td>
			<td style="text-align:center">
				<div class="btn-group">
					<a href="#" class="btn btn-mini icon-pencil" data-bind="click: $root.editPlug"></a>
					<a href="#" class="btn btn-mini icon-trash" data-bind="click: $root.removePlug, visible: $root.settings.settings.plugins.tasmota.arrSmartplugs().length > 1"></a>
				</div>
			</td>
		</tr>
	</tbody>
</table>

<div class="control-group">
	<div class="controls">
		<label class="checkbox">
		<input type="checkbox" data-bind="checked: settings.settings.plugins.tasmota.thermal_runaway_monitoring" /> Enable thermal runaway monitoring.
		</label>
	</div>
</div>
<div class="control-group" data-bind="visible: settings.settings.plugins.tasmota.thermal_runaway_monitoring">
	<div class="controls">
		<label class="control-label">{{ _('Max Bed Temp') }}</label>
		<input type="number" min="0" class="input input-small" data-bind="value: settings.settings.plugins.tasmota.thermal_runaway_max_bed" />
	</div>
	<div class="controls">
		<label class="control-label">{{ _('Max Extruder Temp') }}</label>
		<input type="number" min="0" class="input input-small" data-bind="value: settings.settings.plugins.tasmota.thermal_runaway_max_extruder" />
	</div>
</div>

<div class="control-group">
	<div class="controls">
		<label class="checkbox">
		<input type="checkbox" data-bind="checked: settings.settings.plugins.tasmota.debug_logging"> Enable debug logging.
		</label>
	</div>
</div>
<div class="control-group">
	<div class="controls">
		<label class="checkbox">
		<input type="checkbox" data-bind="checked: settings.settings.plugins.tasmota.polling_enabled"> Enable status polling.
		</label>
	</div>
</div>
<div class="control-group" data-bind="visible: settings.settings.plugins.tasmota.polling_enabled">
	<div class="controls">
		<label class="control-label">{{ _('Minutes between checks') }}</label>
		<input type="number" min="0" class="input input-small" data-bind="value: settings.settings.plugins.tasmota.polling_interval" />
	</div>
</div>

<div id="TasmotaEditor" data-bind="with: selectedPlug" class="modal hide fade">
	<div class="modal-header">
		<a href="#" class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
		<h3>Tasmota Editor</h3>
	</div>
	<div class="modal-body">
		<table class="table table-condensed">
			<tr>
				<td><div class="control-group" data-bind="css: {error: ip().match(/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/) == null}"><div class="controls"><label class="control-label">{{ _('IP') }}</label><input type="text" class="input-block-level" data-bind="value: ip, valueUpdate: 'keyup'" /><div></div></td>
				<td><div class="controls"><label class="control-label">{{ _('Index') }}</label><input type="number" min="1" class="input-block-level" data-bind="value: idx" /><div></td>
				<td><div class="controls"><label class="control-label">{{ _('Label') }}</label><input type="text" class="input input-small" data-bind="value: label" /></div></td>
			</tr>
			<tr>
				<td colspan="3" style="text-align: center;"><button class="btn" data-bind="click: $root.checkSetOption26, enable: ip().match(/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/)">Verify Tasmota Settings</button></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="control-label"><a href="https://fontawesome.com/v3.2.1/icons/" target="_blank">{{ _('Icon Class') }}</a></label><input type="text" class="input-block-level" data-bind="value: icon" /><div></td>
				<td><div class="controls"><label class="control-label">{{ _('Username') }}</label><input type="text" class="input-block-level" data-bind="value: username" /><div></td>
				<td><div class="controls"><label class="control-label">{{ _('Password') }}</label><input type="text" class="input input-small" data-bind="value: password" /></div></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="control-label">{{ _('On Color') }}</label><input type="text" class="input-block-level" data-bind="value: on_color" /><div></td>
				<td><div class="controls"><label class="control-label">{{ _('Off Color') }}</label><input type="text" class="input-block-level" data-bind="value: off_color" /><div></td>
				<td><div class="controls"><label class="control-label">{{ _('Unknown Color') }}</label><input type="text" class="input input-small" data-bind="value: unknown_color" /></div></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="control-label">{{ _('Sensor Identifier') }}</label><input type="text" class="input-block-level" data-bind="value: sensor_identifier" /><div></td>
				<td></td>
				<td></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: use_backlog"/> Use Countdown Timers</label></div></td>
				<td></td>
				<td></td>
			</tr>
			<tr data-bind="visible: use_backlog">
				<td><div class="controls"><label class="control-label">{{ _('On Delay Countdown') }}</label><input type="number" min="0" data-bind="value: backlog_on_delay" class="input input-small" /></div></td>
				<td><div class="controls"><label class="control-label">{{ _('Off Delay Countdown') }}</label><input type="number" min="0" data-bind="value: backlog_off_delay" class="input input-small" /></div></td>
				<td></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: displayWarning"/> Warning Prompt</label></div></td>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: warnPrinting"/> Warn While Printing</label></div></td>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: thermal_runaway"/> Thermal Runaway</label></div></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: autoConnect"/> Auto Connect</label><input type="text" data-bind="value: autoConnectDelay,visible: autoConnect" class="input input-small" /></div></td>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: autoDisconnect"/> Auto Disconnect</label><input type="text" data-bind="value: autoDisconnectDelay,visible: autoDisconnect" class="input input-small" /></div></td>
			</tr>
			<tr>
				<td><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: gcodeEnabled"/> GCODE Trigger</label></div></td>
				<td><span class="label" title="Use this gcode command to power on relay." data-bind="text: $root.gcodeOnString($data),visible: gcodeEnabled"></span></td>
				<td><span class="label" title="Use this gcode command to power off relay." data-bind="text: $root.gcodeOffString($data),visible: gcodeEnabled"></span></td>
			</tr>
			<tr data-bind="visible: gcodeEnabled">
				<td><div class="controls"><label class="control-label">{{ _('GCODE On Delay') }}</label><input type="text" data-bind="value: gcodeOnDelay" class="input input-small" /></div></td>
				<td><div class="controls"><label class="control-label">{{ _('GCODE Off Delay') }}</label><input type="text" data-bind="value: gcodeOffDelay" class="input input-small" /></div></td>
				<td></td>
			</tr>
			<tr>
				<td colspan="2" style="vertical-align: bottom"><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: sysCmdOn"/> Run System Command After On</label><input type="text" data-bind="value: sysRunCmdOn,visible: sysCmdOn" class="input-block-level" /></div></td>
				<td style="vertical-align: bottom"><div class="controls" data-bind="visible: sysRunCmdOn"><label class="control-label">{{ _('Delay') }}</label><input type="text" data-bind="value: sysCmdOnDelay"  class="input input-small" /></div></td>
			</tr>
			<tr>
				<td colspan="2" style="vertical-align: bottom"><div class="controls"><label class="checkbox"><input type="checkbox" data-bind="checked: sysCmdOff"/> Run System Command Before Off</label><input type="text" data-bind="value: sysRunCmdOff,visible: sysCmdOff" class="input-block-level" /></div></td>
				<td style="vertical-align: bottom"><div class="controls" data-bind="visible: sysRunCmdOff"><label class="control-label">{{ _('Delay') }}</label><input type="text" data-bind="value: sysCmdOffDelay"  class="input input-small" /></div></td>
			</tr>
		</table>
	</div>
	<div class="modal-footer">
		<a href="#" class="btn" data-dismiss="modal" aria-hidden="true">{{ _('Close') }}</a>
	</div>
</div>
